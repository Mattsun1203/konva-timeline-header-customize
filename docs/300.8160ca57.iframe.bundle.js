(self.webpackChunk_melfore_konva_timeline=self.webpackChunk_melfore_konva_timeline||[]).push([[300],{"./src/tasks/components/Tooltip/index.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{Z:function(){return components_Tooltip}});var react=__webpack_require__("./node_modules/react/index.js"),ReactKonva=__webpack_require__("./node_modules/react-konva/es/ReactKonva.js"),client=__webpack_require__("./node_modules/react-dom/client.js"),__rest=function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t};const Html=({children:children,groupProps:groupProps,divProps:divProps,transform:transform,transformFunc:transformFunc})=>{const groupRef=react.useRef(null),[div]=(react.useRef(),react.useState((()=>document.createElement("div")))),root=react.useMemo((()=>client.createRoot(div)),[div]),shouldTransform=null==transform||transform,handleTransform=function useEvent(fn=(()=>{})){const ref=react.useRef(fn);return ref.current=fn,react.useCallback(((...args)=>ref.current.apply(null,args)),[])}((()=>{if(shouldTransform&&groupRef.current){let attrs=groupRef.current.getAbsoluteTransform().decompose();transformFunc&&(attrs=transformFunc(attrs)),div.style.position="absolute",div.style.zIndex="10",div.style.top="0px",div.style.left="0px",div.style.transform=`translate(${attrs.x}px, ${attrs.y}px) rotate(${attrs.rotation}deg) scaleX(${attrs.scaleX}) scaleY(${attrs.scaleY})`,div.style.transformOrigin="top left"}else div.style.position="",div.style.zIndex="",div.style.top="",div.style.left="",div.style.transform="",div.style.transformOrigin="";const _a=divProps||{},{style:style}=_a,restProps=__rest(_a,["style"]);Object.assign(div.style,style),Object.assign(div,restProps)}));return react.useLayoutEffect((()=>{var _a;const group=groupRef.current;if(!group)return;const parent=null===(_a=group.getStage())||void 0===_a?void 0:_a.container();return parent?(parent.appendChild(div),shouldTransform&&(el=>{const pos=window.getComputedStyle(el).position;return!("absolute"===pos||"relative"===pos)})(parent)&&(parent.style.position="relative"),group.on("absoluteTransformChange",handleTransform),handleTransform(),()=>{var _a;group.off("absoluteTransformChange",handleTransform),null===(_a=div.parentNode)||void 0===_a||_a.removeChild(div)}):void 0}),[shouldTransform]),react.useLayoutEffect((()=>{handleTransform()}),[divProps,transformFunc]),react.useLayoutEffect((()=>{root.render(children)})),react.useLayoutEffect((()=>()=>{setTimeout((()=>{root.unmount()}))}),[]),react.createElement(ReactKonva.ZA,Object.assign({ref:groupRef},groupProps))};__webpack_require__("./node_modules/use-image/index.js");var luxon=__webpack_require__("./node_modules/luxon/src/luxon.js"),TimelineContext=__webpack_require__("./src/timeline/TimelineContext.tsx"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");function cov_2fcno329eq(){var path="/home/runner/work/konva-timeline/konva-timeline/src/tasks/components/Tooltip/index.tsx",global=new Function("return this")(),gcv="__coverage__",coverageData={path:"/home/runner/work/konva-timeline/konva-timeline/src/tasks/components/Tooltip/index.tsx",statementMap:{0:{start:{line:13,column:27},end:{line:13,column:31}},1:{start:{line:14,column:30},end:{line:14,column:32}},2:{start:{line:15,column:22},end:{line:15,column:24}},3:{start:{line:16,column:26},end:{line:16,column:34}},4:{start:{line:17,column:23},end:{line:17,column:32}},5:{start:{line:21,column:42},end:{line:139,column:1}},6:{start:{line:35,column:6},end:{line:35,column:26}},7:{start:{line:36,column:24},end:{line:38,column:13}},8:{start:{line:37,column:4},end:{line:37,column:78}},9:{start:{line:39,column:22},end:{line:41,column:11}},10:{start:{line:40,column:4},end:{line:40,column:76}},11:{start:{line:42,column:21},end:{line:44,column:27}},12:{start:{line:43,column:4},end:{line:43,column:37}},13:{start:{line:46,column:19},end:{line:58,column:18}},14:{start:{line:47,column:17},end:{line:47,column:44}},15:{start:{line:48,column:4},end:{line:51,column:5}},16:{start:{line:49,column:18},end:{line:49,column:77}},17:{start:{line:50,column:6},end:{line:50,column:62}},18:{start:{line:52,column:4},end:{line:55,column:5}},19:{start:{line:53,column:19},end:{line:53,column:76}},20:{start:{line:54,column:6},end:{line:54,column:64}},21:{start:{line:56,column:16},end:{line:56,column:72}},22:{start:{line:57,column:4},end:{line:57,column:60}},23:{start:{line:60,column:24},end:{line:79,column:41}},24:{start:{line:61,column:4},end:{line:66,column:5}},25:{start:{line:62,column:6},end:{line:64,column:7}},26:{start:{line:63,column:8},end:{line:63,column:59}},27:{start:{line:65,column:6},end:{line:65,column:60}},28:{start:{line:68,column:4},end:{line:73,column:5}},29:{start:{line:69,column:6},end:{line:71,column:7}},30:{start:{line:70,column:8},end:{line:70,column:63}},31:{start:{line:72,column:6},end:{line:72,column:64}},32:{start:{line:75,column:4},end:{line:77,column:5}},33:{start:{line:76,column:6},end:{line:76,column:61}},34:{start:{line:78,column:4},end:{line:78,column:62}},35:{start:{line:80,column:2},end:{line:138,column:4}}},fnMap:{0:{name:"(anonymous_0)",decl:{start:{line:21,column:42},end:{line:21,column:43}},loc:{start:{line:30,column:6},end:{line:139,column:1}},line:30},1:{name:"(anonymous_1)",decl:{start:{line:36,column:32},end:{line:36,column:33}},loc:{start:{line:36,column:38},end:{line:38,column:3}},line:36},2:{name:"(anonymous_2)",decl:{start:{line:39,column:30},end:{line:39,column:31}},loc:{start:{line:39,column:36},end:{line:41,column:3}},line:39},3:{name:"(anonymous_3)",decl:{start:{line:42,column:29},end:{line:42,column:30}},loc:{start:{line:42,column:35},end:{line:44,column:3}},line:42},4:{name:"(anonymous_4)",decl:{start:{line:46,column:27},end:{line:46,column:28}},loc:{start:{line:46,column:33},end:{line:58,column:3}},line:46},5:{name:"(anonymous_5)",decl:{start:{line:60,column:32},end:{line:60,column:33}},loc:{start:{line:60,column:38},end:{line:79,column:3}},line:60}},branchMap:{0:{loc:{start:{line:48,column:4},end:{line:51,column:5}},type:"if",locations:[{start:{line:48,column:4},end:{line:51,column:5}},{start:{line:void 0,column:void 0},end:{line:void 0,column:void 0}}],line:48},1:{loc:{start:{line:52,column:4},end:{line:55,column:5}},type:"if",locations:[{start:{line:52,column:4},end:{line:55,column:5}},{start:{line:void 0,column:void 0},end:{line:void 0,column:void 0}}],line:52},2:{loc:{start:{line:61,column:4},end:{line:66,column:5}},type:"if",locations:[{start:{line:61,column:4},end:{line:66,column:5}},{start:{line:void 0,column:void 0},end:{line:void 0,column:void 0}}],line:61},3:{loc:{start:{line:62,column:6},end:{line:64,column:7}},type:"if",locations:[{start:{line:62,column:6},end:{line:64,column:7}},{start:{line:void 0,column:void 0},end:{line:void 0,column:void 0}}],line:62},4:{loc:{start:{line:68,column:4},end:{line:73,column:5}},type:"if",locations:[{start:{line:68,column:4},end:{line:73,column:5}},{start:{line:void 0,column:void 0},end:{line:void 0,column:void 0}}],line:68},5:{loc:{start:{line:69,column:6},end:{line:71,column:7}},type:"if",locations:[{start:{line:69,column:6},end:{line:71,column:7}},{start:{line:void 0,column:void 0},end:{line:void 0,column:void 0}}],line:69},6:{loc:{start:{line:75,column:4},end:{line:77,column:5}},type:"if",locations:[{start:{line:75,column:4},end:{line:77,column:5}},{start:{line:void 0,column:void 0},end:{line:void 0,column:void 0}}],line:75},7:{loc:{start:{line:128,column:11},end:{line:134,column:11}},type:"binary-expr",locations:[{start:{line:128,column:11},end:{line:128,column:30}},{start:{line:129,column:12},end:{line:133,column:18}}],line:128}},s:{0:0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:0,11:0,12:0,13:0,14:0,15:0,16:0,17:0,18:0,19:0,20:0,21:0,22:0,23:0,24:0,25:0,26:0,27:0,28:0,29:0,30:0,31:0,32:0,33:0,34:0,35:0},f:{0:0,1:0,2:0,3:0,4:0,5:0},b:{0:[0,0],1:[0,0],2:[0,0],3:[0,0],4:[0,0],5:[0,0],6:[0,0],7:[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"e258ca750c9f08483dcbcde9322678c02245e84a"},coverage=global[gcv]||(global[gcv]={});coverage[path]&&"e258ca750c9f08483dcbcde9322678c02245e84a"===coverage[path].hash||(coverage[path]=coverageData);var actualCoverage=coverage[path];return cov_2fcno329eq=function(){return actualCoverage},actualCoverage}cov_2fcno329eq();const rightMarginOffsetX=(cov_2fcno329eq().s[0]++,-230),standardMarginOffsetX=(cov_2fcno329eq().s[1]++,15),marginOffsetY=(cov_2fcno329eq().s[2]++,25),sevenHourinMillis=(cov_2fcno329eq().s[3]++,252e5),twoDayinMillis=(cov_2fcno329eq().s[4]++,1728e5);cov_2fcno329eq().s[5]++;const TaskTooltip=({task:{label:label,completedPercentage:completedPercentage,time:{start:start,end:end},resourceId:resourceId},x:x,y:y})=>{cov_2fcno329eq().f[0]++;const{drawRange:{end:drawEnd},resources:resources,localized:localized}=(cov_2fcno329eq().s[6]++,(0,TimelineContext.i)()),startDuration=(cov_2fcno329eq().s[7]++,(0,react.useMemo)((()=>(cov_2fcno329eq().f[1]++,cov_2fcno329eq().s[8]++,luxon.ou.fromMillis(Number(start)).toFormat("dd/MM/yyyy HH:mm:ss"))),[start])),endDuration=(cov_2fcno329eq().s[9]++,(0,react.useMemo)((()=>(cov_2fcno329eq().f[2]++,cov_2fcno329eq().s[10]++,luxon.ou.fromMillis(Number(end)).toFormat("dd/MM/yyyy HH:mm:ss"))),[end])),percentage=(cov_2fcno329eq().s[11]++,(0,react.useMemo)((()=>(cov_2fcno329eq().f[3]++,cov_2fcno329eq().s[12]++,completedPercentage+"%")),[completedPercentage])),duration=(cov_2fcno329eq().s[13]++,(0,react.useMemo)((()=>{cov_2fcno329eq().f[4]++;const part=(cov_2fcno329eq().s[14]++,Number(end)-Number(start));if(cov_2fcno329eq().s[15]++,part<sevenHourinMillis){cov_2fcno329eq().b[0][0]++;const min=(cov_2fcno329eq().s[16]++,luxon.nL.fromObject({millisecond:part}).as("minute"));return cov_2fcno329eq().s[17]++,{time:Math.round(10*min)/10,unit:"min"}}if(cov_2fcno329eq().b[0][1]++,cov_2fcno329eq().s[18]++,part<twoDayinMillis){cov_2fcno329eq().b[1][0]++;const hour=(cov_2fcno329eq().s[19]++,luxon.nL.fromObject({millisecond:part}).as("hour"));return cov_2fcno329eq().s[20]++,{time:Math.round(10*hour)/10,unit:"hour"}}cov_2fcno329eq().b[1][1]++;const day=(cov_2fcno329eq().s[21]++,luxon.nL.fromObject({millisecond:part}).as("day"));return cov_2fcno329eq().s[22]++,{time:Math.round(10*day)/10,unit:"Day"}}),[start,end])),offsetToolTip=(cov_2fcno329eq().s[23]++,(0,react.useMemo)((()=>(cov_2fcno329eq().f[5]++,cov_2fcno329eq().s[24]++,resourceId===resources[1].id?(cov_2fcno329eq().b[2][0]++,cov_2fcno329eq().s[25]++,x>drawEnd+rightMarginOffsetX?(cov_2fcno329eq().b[3][0]++,cov_2fcno329eq().s[26]++,{x:rightMarginOffsetX,y:marginOffsetY}):(cov_2fcno329eq().b[3][1]++,cov_2fcno329eq().s[27]++,{x:standardMarginOffsetX,y:marginOffsetY})):(cov_2fcno329eq().b[2][1]++,cov_2fcno329eq().s[28]++,resourceId===resources[resources.length-1].id?(cov_2fcno329eq().b[4][0]++,cov_2fcno329eq().s[29]++,x>drawEnd+rightMarginOffsetX?(cov_2fcno329eq().b[5][0]++,cov_2fcno329eq().s[30]++,{x:rightMarginOffsetX,y:4*marginOffsetY}):(cov_2fcno329eq().b[5][1]++,cov_2fcno329eq().s[31]++,{x:standardMarginOffsetX,y:4*marginOffsetY})):(cov_2fcno329eq().b[4][1]++,cov_2fcno329eq().s[32]++,x>drawEnd+rightMarginOffsetX?(cov_2fcno329eq().b[6][0]++,cov_2fcno329eq().s[33]++,{x:rightMarginOffsetX,y:2*marginOffsetY}):(cov_2fcno329eq().b[6][1]++,cov_2fcno329eq().s[34]++,{x:standardMarginOffsetX,y:2*marginOffsetY}))))),[drawEnd,resourceId,x,resources]));return cov_2fcno329eq().s[35]++,(0,jsx_runtime.jsx)(ReactKonva.__,{x:x+offsetToolTip.x,y:y-offsetToolTip.y,opacity:1,children:(0,jsx_runtime.jsx)(Html,{children:(0,jsx_runtime.jsxs)("div",{style:{backgroundColor:"white",border:"ridge",borderColor:"black",borderWidth:"1px",padding:8,boxShadow:"2px 2px 8px black",maxWidth:200,overflow:"hidden",textOverflow:"ellipsis"},children:[(0,jsx_runtime.jsx)("b",{style:{fontFamily:"Times New Roman",fontSize:16,fontWeight:700},children:label}),(0,jsx_runtime.jsx)("br",{}),(0,jsx_runtime.jsxs)("div",{style:{display:"inline-flex",alignItems:"center"},children:[(0,jsx_runtime.jsxs)("b",{style:{fontSize:14,fontFamily:"Times New Roman",fontWeight:700},children:[localized.start,": "]}),"   ",(0,jsx_runtime.jsx)("span",{style:{fontFamily:"Courier New",fontSize:13},children:startDuration})]}),(0,jsx_runtime.jsx)("br",{}),(0,jsx_runtime.jsxs)("div",{style:{display:"inline-flex",alignItems:"center"},children:[(0,jsx_runtime.jsxs)("b",{style:{fontSize:14,fontFamily:"Times New Roman",fontWeight:700},children:[localized.end,": "]}),"   ",(0,jsx_runtime.jsx)("span",{style:{fontFamily:"Courier New",fontSize:13},children:endDuration})]}),(0,jsx_runtime.jsx)("br",{}),(0,jsx_runtime.jsxs)("div",{style:{display:"inline-flex",alignItems:"center"},children:[(0,jsx_runtime.jsxs)("b",{style:{fontFamily:"Times New Roman",fontSize:14,fontWeight:700},children:[localized.duration,": "]}),"   ",(0,jsx_runtime.jsxs)("span",{style:{fontFamily:"Courier New",fontSize:13},children:[duration.time," ",duration.unit,"(s)"]})]}),(0,jsx_runtime.jsx)("br",{}),(cov_2fcno329eq().b[7][0]++,completedPercentage&&(cov_2fcno329eq().b[7][1]++,(0,jsx_runtime.jsxs)("div",{style:{display:"inline-flex",alignItems:"center"},children:[(0,jsx_runtime.jsxs)("b",{style:{fontFamily:"Times New Roman",fontSize:14,fontWeight:700},children:[localized.completed,": "]}),"   ",(0,jsx_runtime.jsx)("span",{style:{fontFamily:"Courier New",fontSize:13},children:percentage})]})))]})})})};TaskTooltip.displayName="TaskTooltip";var components_Tooltip=TaskTooltip;try{Tooltip.displayName="Tooltip",Tooltip.__docgenInfo={description:"This component renders a task tooltip inside a canvas.",displayName:"Tooltip",props:{task:{defaultValue:null,description:"",name:"task",required:!0,type:{name:"TaskData<TimeRange>"}},x:{defaultValue:null,description:"The x coordinate of a point on canvas",name:"x",required:!0,type:{name:"number"}},y:{defaultValue:null,description:"The y coordinate of a point on canvas",name:"y",required:!0,type:{name:"number"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/tasks/components/Tooltip/index.tsx#Tooltip"]={docgenInfo:Tooltip.__docgenInfo,name:"Tooltip",path:"src/tasks/components/Tooltip/index.tsx#Tooltip"})}catch(__react_docgen_typescript_loader_error){}},"./node_modules/use-image/index.js":function(module,__unused_webpack_exports,__webpack_require__){var React=__webpack_require__("./node_modules/react/index.js");module.exports=function useImage(url,crossOrigin,referrerpolicy){const statusRef=React.useRef("loading"),imageRef=React.useRef(),[_,setStateToken]=React.useState(0),oldUrl=React.useRef(),oldCrossOrigin=React.useRef(),oldReferrerPolicy=React.useRef();return oldUrl.current===url&&oldCrossOrigin.current===crossOrigin&&oldReferrerPolicy.current===referrerpolicy||(statusRef.current="loading",imageRef.current=void 0,oldUrl.current=url,oldCrossOrigin.current=crossOrigin,oldReferrerPolicy.current=referrerpolicy),React.useLayoutEffect((function(){if(url){var img=document.createElement("img");return img.addEventListener("load",onload),img.addEventListener("error",onerror),crossOrigin&&(img.crossOrigin=crossOrigin),referrerpolicy&&(img.referrerPolicy=referrerpolicy),img.src=url,function cleanup(){img.removeEventListener("load",onload),img.removeEventListener("error",onerror)}}function onload(){statusRef.current="loaded",imageRef.current=img,setStateToken(Math.random())}function onerror(){statusRef.current="failed",imageRef.current=void 0,setStateToken(Math.random())}}),[url,crossOrigin,referrerpolicy]),[imageRef.current,statusRef.current]}}}]);